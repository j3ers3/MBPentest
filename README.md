# MacBook Pro for Pentest
***
## Introduction 😈
**MBPentest**，自己的MBP配置手册


<br><br>

## Github相关
- [awesome-mac](https://github.com/jaywcjlove/awesome-mac)
- [my-mac-os](https://github.com/nikitavoloboev/my-mac-os)
- [Best-App](https://github.com/hzlzh/Best-App)


<br><br>

## 快捷方式 🌚
- 新建文件 `选中文字 -> 拖出去`
- 新建标签 `Command + T`
- 新建窗口 `Command + N`
- 切换标签 `Command + Num`
- 关闭标签 `Command + W`
- 全屏 `Command + Control + F`
- 设置 `Command + ,`
- 删除文件 `Command + Delete`
- 清空垃圾桶 `Shift + Command + Delete`
- 锁屏 `Control + Command + Q`
- 截整个屏幕 `Command + Shift + 3`
- 截取选择区域 `Command + Shift + 4`                  
- 截取bar `Command + Shift + 5`
- 最小化窗口 `Command + M`
>command + tab 然后按option来恢复最小化的窗口
- 快速隐藏窗口 `Command + H`
- 打开便签，快速记录 `复制-> Command + Shift + Y`
- 在当前文件夹进入终端(自定义) `Command + ;`
- finder 进入目录 `Shift + Command + G`
- home `Control + a`
- end `Control + e`
- page down `fn + down`
- page up `fn + up`
- 显示桌面 `F11 or 四🈯️分开`
- 显示控制台 `四🈯️🈴️拢`
- 查看字典 `三🈯️点击`
- 前进\后退 `双🈯️左右滑`


<br><br>

## Iterm2 🦇
- [官网](https://iterm2.com/)

#### Install zsh
```bash
brew install zsh zsh-syntax-highlighting
```

#### Install oh-my-zsh
```bash
sh -c $(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)
```

#### Install powerline字体
```bash
git clone https://github.com/powerline/fonts.git
cd fonts
./install.sh
```
>选的字体Roboto Mono Medium for Powerline 14pt


#### 配置
- Keys -> Hotkey 设置 `command + l` 快速显示和隐藏 iTerm

- [极好的配色](https://github.com/mbadolato/iTerm2-Color-Schemes)

![字体](./screenshots/iterm2-font.png)


#### 配置.zshrc
```bash
ZSH_THEME=ys
source /usr/local/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh

配置alias
alias proxy_ss="export http_proxy=http://127.0.0.1:1087;export https_proxy=http://127.0.0.1:1087;"
alias proxy_burp="export http_proxy=http://127.0.0.1:8080"
alias proxy_reset="unset http_proxy;unset https_proxy"
```

#### 窗口操作
- shift + command + d（横切）
- command + d（竖切）
- command + [] （切屏）


<br><br>

## Homebrew 😍
**Homebrew**, OS X 系统中最受欢迎的包管理工具

- [官网](https://brew.sh)
- [Github](https://github.com/Homebrew/brew)
- Homebrew Cask [官网](http://caskroom.io/)

1. Install
```ruby
ruby -e $(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)
```
>安装完成后，Homebrew 会将本地 /usr/local 初始化为 git 的工作树，并将目录所有者变更为当前所操作的用户，将来 brew 的相关操作不需要 sudo

2. Help
```bash
brew install         
brew cask install   
brew update
brew upgrade <package_name>
brew info <package_name> 
brew list --versions
brew cask list --versions
brew doctor
brew uninstall
brew cleanup 
brew services list
brew services start mysql
```


<br><br>

## Metasploit Framework 😘
- [Github](https://github.com/rapid7/metasploit-framework)

#### Install
- 安装rvm
```
curl -sSL https://get.rvm.io | bash -s stable
source /etc/profile.d/rvm.sh
rvm install 2.5.3
rvm use 2.5.3 --default
```

- bundle 改源
```bash
bundle config 'mirror.https://rubygems.org' 'https://ruby.taobao.org'
```

- install
```bash
git clone https://github.com/rapid7/metasploit-framework.git
brew install libxml2
brew install sqlite3
brew install postgresql
gem install bundle
bundle install
```

- 解决pg安装失败
```bash
sudo env ARCHFLAGS=-arch x86_64 gem install pg -v '0.20.0'
```

- 解决sqlite3安装失败
```bash
sudo gem install sqlite3 -v '1.3.13' -- --with-sqlite3-dir=/usr/local/opt   指定sqlite3的路径
```

#### Postgres配置
- alias配置
```bash
alias pg_start=pg_ctl -D /usr/local/var/postgres@9.6 -l /usr/local/var/postgres@9.6/server.log start
alias pg_start=pg_ctl -D /usr/local/var/postgres@9.6 -l /usr/local/var/postgres@9.6/server.log stop
```
- 数据库
```bash
createuser msf -P
createdb -p 5432 msfdb
psql -U msf msfdb
```

![msf](./screenshots/msf.png)


<br><br>

## Cobalt Strike 😘
- [官网](https://www.cobaltstrike.com/)

#### 简单破解
```
0x01
    解压 cobaltstrike.jar
0x02 
    jad common\License.class
    得到 License.java
0x03
    vim License.java
    private static long life = 65535L
0x04 
    javac进行编译得到 License.class
    javac  common\License.java
0x05
    将License.class 放入cobaltstrike.jar原来的位置替换
```

![cobalt](./screenshots/cobalt.png)


<br><br>

## 代理模式 🤪
### 1. proxychains
#### Install
```bash
brew install proxychains-ng
```
#### 问题
无法全部程序代理，只能在homebrew bin目录下的程序可代理
```bash
brew link curl  --force
proxychains curl ipconfig.io
```
### 2. Proxifier
- [官网](https://www.proxifier.com)
> 内网穿透常用

#### 序列号
- L6Z8A-XY2J4-BTZ3P-ZZ7DF-A2Q9C（携带版）
- 5EZ8G-C3WL5-B56YG-SCXM9-6QZAP（标准版）
- P427L-9Y552-5433E-8DSR3-58Z68（MAC）

### 3. ShadowsocksX-NG
- [Github](https://github.com/shadowsocks/ShadowsocksX-NG)

```json
{
    "server":"0.0.0.0",
    "server_port":9999,
    "local_port":1080,
    "password":"pass",
    "timeout":600,
    "method":"aes-256-cfb"
}
```
### 4. ShadowsocksX-NG-R8
老版本，兼容ss和ssr
![ssr](./screenshots/ssr.png)

### 5. v2ray
- [Github](https://github.com/v2ray/v2ray-core)


<br><br>

## 开发环境相关 😎

### Sublime3

### IDEA

### Node

### Go


<br><br>

## 目录情况 😵
- brew 安装程序目录 `/usr/local/Cellar`  
- brew 配置程序目录 `/usr/local/etc`     
- /usr/local/Cellar里程序的软连接 `/usr/local/opt`           
- dmg安装的应用 `/Applications`            
- Xcode command line tools `/Library/Developer/CommandLineTools/usr/bin`
- iBooks书目录 `~/Library/containers/com.apple.BKAgentService/Data/Documents/iBooks/Books`
- pip `/usr/local/lib/python2.7/site-packages`
- pip3 `/usr/local/lib/python3.7/site-packages`
- 开机启动 `~/Library/LaunchAgents`
- 驱动目录 `/System/Library/Extensions`


<br><br>

## 一些命令 🎃
- say 将文本转为语音
```bash
say 你好
say -v '?' | grep zh
say -v mei-jia 你好
say -f test.txt -o test.aif #将文本转换为音频
```

- 显示监听端口
```bash
lsof -nP -iTCP -sTCP:LISTE
netstat -an | grep LISTEN
```

- 开机启动命令
```bash
launchctl list
launchctl stop com.philandro.anydesk
launchctl unload com.philandro.anydesk
```

- open命令
```
open .     > 打开当前目录
open -e    > 打开编辑器
```


<br><br>

### 杂七杂八的问题 😳
- 索引
```bash
mds_stores
mdutil -a -i off
mdutil -a -i on
```

- 休眠时断网
```bash
sudo pmset -b tcpkeepalive 0  
```

- Mojave中开启深色菜单栏和dock栏
```
1. 使用浅色主题
2. defaults write -g NSRequiresAquaSystemAppearance -bool Yes
3. 退出账号重新登录，选择暗色主题

> 完全恢复暗色主题
> 使用浅色主题下
> defaults write -g NSRequiresAquaSystemAppearance -bool No
```

- Termius键盘长安问题
```bash
defaults write -g ApplePressAndHoldEnabled -bool false
重启
```
    
- Finder 标题显示路径
```bash
defaults write com.apple.finder _FXShowPosixPathInTitle -bool TRUE;killall Finder
恢复
defaults delete com.apple.finder _FXShowPosixPathInTitle;killall Finder
```
    
- 命令工具中文变英文
```bash
sudo languagesetup
```

- pd工具的问题
```bash
mount -o exec /dev/cdrom /media/cdrom
cd /media/cdrom/
sudo ./install
```

<br><br>

![封面](./screenshots/e.jpg)








