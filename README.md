# MacBook Pro for Pentest
## 😈 Introduction 
**MBPentest**，自己的MBP配置手册


<br>

## 🦀 1. Github相关
- [awesome-mac](https://github.com/jaywcjlove/awesome-mac)
- [my-mac-os](https://github.com/nikitavoloboev/my-mac-os)
- [Best-App](https://github.com/hzlzh/Best-App)


<br>

## 🌚 2. 快捷方式 
- 新建文件 `选中文字 -> 拖出去`
- 新建标签 `Command + T`
- 新建窗口 `Command + N`
- 切换标签 `Command + Num`
- 关闭标签 `Command + W`
- 全屏 `Command + Control + F`
- 设置 `Command + ,`
- 删除文件 `Command + Delete`
- 清空垃圾桶 `Shift + Command + Delete`
- 锁屏 `Control + Command + Q`
- 截整个屏幕 `Command + Shift + 3`
- 截取选择区域 `Command + Shift + 4`                  
- 截取bar `Command + Shift + 5`
- 最小化窗口 `Command + M`
>command + tab 然后按option来恢复最小化的窗口
- 快速隐藏窗口 `Command + H`
- 打开便签，快速记录 `复制-> Command + Shift + Y`
- 在当前文件夹进入终端(自定义) `Command + ;`
- finder 进入目录 `Shift + Command + G`
- home `Control + a`
- end `Control + e`
- page down `fn + down`
- page up `fn + up`
- 显示桌面 `F11 or 四🈯️分开`
- 显示控制台 `四🈯️🈴️拢`
- 查看字典 `三🈯️点击`
- 前进\后退 `双🈯️左右滑`
- option+单击dock图标 `最小化`

<br>

## ☂️ 3. 热键工具
[SpaceLauncher](https://spacelauncherapp.com)

![space](./screenshots/spacelauncher.png)

快捷键|功能
-|-
长按Space|            显示快捷列表
Space + S|           打开Sublime应用
Space + I|           打开Iterm2应用
Space + W|           打开微信应用
Space + G|           打开Google页面          
Space + F then D|    打开下载文件夹
Space + F then T|    打开🔧文件夹

<br>

## 🥀 4. mac瑞士军刀
- [Github](https://github.com/rgcr/m-cli)

### 4.1 Install
```
brew install m-cli
```

### 4.2 使用
- m help
- m battery status 显示电量
- m wifi showpassword 显示当前wifi密码
- m firewall disable 关闭防火墙
- m trash clean 清理垃圾箱
- 其他见github

<br>

## 💥 5. 终端配置 
使用Iterm2配合zsh

- [Iterm2](https://iterm2.com/)
- zsh

### 5.1 Install oh-my-zsh
```bash
sh -c $(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)
```

### 5.2 Install zsh-autosuggestions
输入命令时可提示自动补全，然后按键盘 → 即可补全.
```bash
git clone git://github.com/zsh-users/zsh-autosuggestions $ZSH_CUSTOM/plugins/zsh-autosuggestions
```
配置.zshrc
```
plugins=(zsh-autosuggestions)
```

### 5.3 Install zsh-syntax-highlighting
日常用的命令会高亮显示
```bash
git clone https://github.com/zsh-users/zsh-syntax-highlighting.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-syntax-highlighting
```
配置.zshrc
```
plugins=(zsh-syntax-highlighting)
```

### 5.4 Install autojump
实现目录间快速跳转，想去哪个目录直接 j + 目录名
```bash
brew install autojump
```
配置.zshrc
```
[ -f /usr/local/etc/profile.d/autojump.sh ] && . /usr/local/etc/profile.d/autojump.sh
```

### 5.5 Install powerline字体
```bash
git clone https://github.com/powerline/fonts.git
cd fonts
./install.sh
```
>选的字体Roboto Mono Medium for Powerline 14pt

### 5.6 Install nerd-fonts字体
[Github](https://github.com/ryanoasis/nerd-fonts)


### 5.7 配置
- Keys -> Hotkey 设置 `command + l` 快速显示和隐藏 iTerm

- [极好的配色](https://github.com/mbadolato/iTerm2-Color-Schemes)

![字体](./screenshots/iterm2-font.png)


### 5.8 ssh管理
配置profile文件,进行ssh管理

![ssh](./screenshots/ssh.png)

> 配置快捷键，启动不同的窗口，或command+o打开profiles界面

 
### 5.9 配置.zshrc
```bash
ZSH_THEME=ys
source /usr/local/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh

配置alias
alias proxy_ss="export http_proxy=http://127.0.0.1:1087;export https_proxy=http://127.0.0.1:1087;"
alias proxy_burp="export http_proxy=http://127.0.0.1:8080"
alias proxy_reset="unset http_proxy;unset https_proxy"
```

### 5.10 快捷键

快捷键|功能
-|-
command + l |热键启动
command + shift + d |横切
command + d |竖切
command + [] |切屏
command + shift + i |多窗口同步命令执行
command + o |打开profiles界面
command + t |打开标签
command + 1 |切换标签


<br>

## ☘️ 6. Homebrew 
**Homebrew**, OS X 系统中最受欢迎的包管理工具

- [官网](https://brew.sh)
- [Github](https://github.com/Homebrew/brew)
- Homebrew Cask [官网](http://caskroom.io/)

### 6.1 Install
```ruby
ruby -e $(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)
```
>安装完成后，Homebrew 会将本地 /usr/local 初始化为 git 的工作树，并将目录所有者变更为当前所操作的用户，将来 brew 的相关操作不需要 sudo

### 6.2 Help
```bash
brew install         
brew cask install   
brew update
brew upgrade <package_name>
brew info <package_name> 
brew list --versions
brew cask list --versions
brew doctor
brew uninstall
brew cleanup 
brew services list
brew services start mysql
```


<br>

## 🔥 7. Metasploit Framework 
- [Github](https://github.com/rapid7/metasploit-framework)

### 7.1 Install
#### 7.1.1 安装rvm
```
curl -sSL https://get.rvm.io | bash -s stable
source /etc/profile.d/rvm.sh
rvm install 2.5.3
rvm use 2.5.3 --default
```

#### 7.1.2 改源
```bash
gem sources --add https://gems.ruby-china.com/ --remove https://rubygems.org/
bundle config mirror.https://rubygems.org https://gems.ruby-china.com
```

#### 7.1.3 install
```bash
git clone https://github.com/rapid7/metasploit-framework.git
brew install libxml2
brew install sqlite3
brew install postgresql
gem install bundle
bundle install
```

> 解决pg安装失败

```bash
sudo env ARCHFLAGS=-arch x86_64 gem install pg -v '0.20.0'
```

> 解决sqlite3安装失败

```bash
sudo gem install sqlite3 -v '1.3.13' -- --with-sqlite3-dir=/usr/local/opt   指定sqlite3的路径
```

### 7.2 Postgres配置
#### 7.2.1 alias配置
```bash
alias pg_start=pg_ctl -D /usr/local/var/postgres@9.6 -l /usr/local/var/postgres@9.6/server.log start
alias pg_start=pg_ctl -D /usr/local/var/postgres@9.6 -l /usr/local/var/postgres@9.6/server.log stop
```

#### 7.2.2 数据库
```bash
createuser msf -P
createdb -p 5432 msfdb
psql -U msf msfdb
```

![msf](./screenshots/msf.png)


<br>

## 🐝 8. Cobalt Strike 
- [官网](https://www.cobaltstrike.com/)

### 8.1 简单破解
```
0x01
    解压 cobaltstrike.jar
0x02 
    jad common\License.class
    得到 License.java
0x03
    vim License.java
    private static long life = 65535L
0x04 
    javac进行编译得到 License.class
    javac  common\License.java
0x05
    将License.class 放入cobaltstrike.jar原来的位置替换
```

![cobalt](./screenshots/cobalt.png)


<br>

## 🦋 9. 代理模式 
### 9.1 proxychains
#### 9.1.1 Install
```bash
brew install proxychains-ng
```
#### 9.1.2 问题
无法全部程序代理，只能在homebrew bin目录下的程序可代理
```bash
brew link curl  --force
proxychains curl ipconfig.io
```
### 9.2 Proxifier
- [官网](https://www.proxifier.com)
> 内网穿透常用

#### 9.2.1 序列号
- L6Z8A-XY2J4-BTZ3P-ZZ7DF-A2Q9C（携带版）
- 5EZ8G-C3WL5-B56YG-SCXM9-6QZAP（标准版）
- P427L-9Y552-5433E-8DSR3-58Z68（MAC）

### 9.3 ShadowsocksX-NG
- [Github](https://github.com/shadowsocks/ShadowsocksX-NG)

```json
{
    "server":"0.0.0.0",
    "server_port":9999,
    "local_port":1080,
    "password":"pass",
    "timeout":600,
    "method":"aes-256-cfb"
}
```
### 9.4 ShadowsocksX-NG-R8
老版本，兼容ss和ssr
![ssr](./screenshots/ssr.png)

### 9.6 v2ray
- [Github](https://github.com/v2ray/v2ray-core)

### 9.7 v2rayu
更加棒的代理工具
- [Github](https://github.com/yanue/v2rayu)

<br>


## 🎭 10. Parallels
Mac下最好用的虚拟机
- [官网](https://parallels.com/)

### 10.1 pd工具的问题
```bash
mount -o exec /dev/cdrom /media/cdrom
cd /media/cdrom/
sudo ./install
```

> linux最新内核安装pdtools需要使用最新的Parallels


## 🦍 11. 开发环境相关 

### 11.1 Sublime3
- [官网](https://www.sublimetext.com/)
- [主题](https://packagecontrol.io/)

#### 11.1.1快捷键
快捷键|功能
-|-
Ctrl + `                            |打开控制台
Command+Shift+P                     |打開控制面板
Ctrl+P                              |文件切换面板   
Ctrl+Command+F                      |全屏                          
Opt+Commad+num                      |分屏
Ctrl+Num                            |跳转到分屏页
Ctrl+j                              |选中的行合并为一行 
Reveal in Finder                    |在finder中打开
长按Command                          |向下多行选择

#### 11.1.2 Preferences.sublime-settings
```json
{
    "color_scheme": "Packages/ayu/ayu-mirage.sublime-color-scheme",
    "dpi_scale": 1.0,
    "font_face": "source code pro for Powerline",
    "font_size": 15,
    "highlight_line": true,
    "ignored_packages":
    [
    ],
    "open_files_in_new_window": false,
    "theme": "ayu-mirage.sublime-theme",
    "word_wrap": true,
    "draw_minimap_border": false,
    "always_show_minimap_viewport": false,

}
```

### 11.2 IDEA
- [官网](https://www.jetbrains.com/idea/)

### 11.3 pycharm
- [官网](https://www.jetbrains.com/pycharm)



<br>

## 🌿 12. 目录情况 
- brew 安装程序目录 `/usr/local/Cellar`  
- brew 配置程序目录 `/usr/local/etc`     
- /usr/local/Cellar里程序的软连接 `/usr/local/opt`           
- dmg安装的应用 `/Applications`            
- Xcode command line tools `/Library/Developer/CommandLineTools/usr/bin`
- iBooks书目录 `~/Library/containers/com.apple.BKAgentService/Data/Documents/iBooks/Books`
- pip `/usr/local/lib/python2.7/site-packages`
- pip3 `/usr/local/lib/python3.7/site-packages`
- 开机启动 `~/Library/LaunchAgents`
- 驱动目录 `/System/Library/Extensions`


<br>

## ⚡️ 13. 自动化操作
- 打包APP
![](./screenshots/打包.png)



<br>

## 🎃 14. 一些命令 
- say 将文本转为语音
```bash
say 你好
say -v '?' | grep zh
say -v mei-jia 你好
say -f test.txt -o test.aif #将文本转换为音频
```

- 显示监听端口
```bash
lsof -nP -iTCP -sTCP:LISTE
netstat -an | grep LISTEN
```

- 开机启动命令
```bash
launchctl list
launchctl stop com.philandro.anydesk
launchctl unload com.philandro.anydesk
```

- open命令
```
open .     > 打开当前目录
open -e    > 打开编辑器
```


<br>

### 😳 15. 杂七杂八的问题 
- 索引
```bash
mds_stores
mdutil -a -i off
mdutil -a -i on
```

- 休眠时断网
```bash
sudo pmset -b tcpkeepalive 0  
```

- Mojave中开启深色菜单栏和dock栏
```
1. 使用浅色主题
2. defaults write -g NSRequiresAquaSystemAppearance -bool Yes
3. 退出账号重新登录，选择暗色主题

> 完全恢复暗色主题
> defaults delete -g NSRequiresAquaSystemAppearance

火狐打不开问题
defaults write org.mozilla.firefox NSRequiresAquaSystemAppearance 1
```

- Termius键盘长安问题
```bash
defaults write -g ApplePressAndHoldEnabled -bool false
重启
```
    
- Finder 标题显示路径
```bash
defaults write com.apple.finder _FXShowPosixPathInTitle -bool TRUE;killall Finder
恢复
defaults delete com.apple.finder _FXShowPosixPathInTitle;killall Finder
```
    
- 命令工具中文变英文
```bash
sudo languagesetup
```

- chrome使用浅色模式
```bash
defaults write com.google.Chrome NSRequiresAquaSystemAppearance -bool YES

defaults write com.google.Chrome NSRequiresAquaSystemAppearance -bool NO
```

<br>

![封面](./screenshots/view.jpg)







